@using SpotGuru.ViewModels
@model SpotGuru.ViewModels.HorarioView

<div>
    <h4>Schedule</h4>
    <hr />
    <dl class="row">
        <dt class = "col-sm-2">
            @Html.DisplayNameFor(model => model.HoraAbertura)
        </dt>
        <dd class = "col-sm-10">
            @Html.DisplayFor(model => model.HoraAbertura)
        </dd>
        <dt class = "col-sm-2">
            @Html.DisplayNameFor(model => model.HoraEncerramento)
        </dt>
        <dd class = "col-sm-10">
            @Html.DisplayFor(model => model.HoraEncerramento)
        </dd>
        <dt class = "col-sm-2">
            @Html.DisplayNameFor(model => model.CustoSlot)
        </dt>
        <dd class = "col-sm-10">
            @Html.DisplayFor(model => model.CustoSlot)
        </dd>
    </dl>
</div>

<link rel="stylesheet" href="/css/HorariosMapa.css" />
<div>
        <h4>Horario</h4>

        <table class="table">
            <tr>
                <th>
                    Inicio
                </th>
                @for(int i = 0; i < 7; i++){
                    <th class="text-center">
                        @Html.DisplayName(Model.DiaAtual.AddDays(i).DayOfWeek.ToString())
                    </th>
                }
            </tr>
        <tbody>

        @for(var i = Model.HoraAbertura; i < Model.HoraEncerramento ; i++) {
                <tr>
                    <td>
                        @TimeSpan.FromMinutes(i*60 + Model.DuracaoSlot)
                    </td>
                    
                    @{
                        for(var dia = 0; dia < 7; dia++)
                        {
                            IdPlusEstadoView ipe = Model.slotDisponibilidade(dia,i);
                            switch(ipe.Estado)
                            {
                                case 1:
                                    <td>
                                        <label class="quadrado">
                                            <input type="checkbox" onclick="FazReserva(id='@ipe.Id')"> 
                                            <span class="checkmark"></span>
                                        </label>
                                    </td>
                                    break;
                                case 2:
                                    <td>
                                        <label class="quadrado">
                                        <input type="checkbox" checked="checked">
                                        <span class="checkmark"></span>
                                        </label>
                                    </td>
                                    break;
                                case 3:
                                    <td>
                                        <label class="ocupado"></label>
                                    </td>
                                    break;
                                default:
                                    <td>
                                        <label class="indisponivel"></label>
                                    </td>
                                    break;
                            }
                        }
                    }
                </tr>
        }
            </tbody>
        </table>
    </div>

    <script>
        var FazReserva = function(id){

            location.href= "/Monumentos/FazReserva?idHorario=" + @Model.Id + "&id=" + id;
            /*
            $.ajax({
                url: "/Monumentos/FazReserva",
                type: "POST",
                data: {Id: id}
            })
            */
        }

    </script>