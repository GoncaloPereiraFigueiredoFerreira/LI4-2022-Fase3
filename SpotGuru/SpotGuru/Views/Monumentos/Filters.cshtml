@using SpotGuru.Helpers
@using SpotGuru.Models
@{
    ViewData["Title"] = "Filters";
    Layout = "~/Views/Shared/_Layout.cshtml";
    <link rel="stylesheet" href="/css/customCheckBox.css" />
}

<h1>Monumentos</h1>

<br />
<h4>Search By Name</h4>
<div>
    <div class="form-group">
        <input id="monumentName" class="form-control" />
    </div>
    <button class="button" onclick="SearchByName()">Search</button>
</div>

<br />
<h4>Search with Filters</h4>
<div id="FiltersList">
    @{
        IEnumerable<Categorias> categorias = Enum.GetValues(typeof(Categorias)).Cast<Categorias>().OrderBy(cat => EnumExtensionMethods.GetDescription(cat));
    }

    @foreach (Categorias cat in categorias)
    {
        <label class="checkBoxContainer">@EnumExtensionMethods.GetDescription(cat)
            <input type="checkbox" id=@cat>
            <span class="checkmark"></span>
        </label>
    }

    <button class="button" onclick="SaveList()">Search</button>

</div>

<script>
    var SaveList = function() {
        
        var arr = [];
        var commaSeparatedIds = "";

        $("#FiltersList label input[type=checkbox]").each(function (index,val){
            var id = $(val).attr("Id");
            var isChecked = $("#" + id).is(":checked",true);
            if(isChecked){
                arr.push(id);
            }
        })

        if(arr.length != 0){
            commaSeparatedIds = arr.toString();
            const url = "/Monumentos/ApplyFilters?FiltersList=" + commaSeparatedIds;
            location.href = url;
        }
        else{
            const url = "/Monumentos";
            location.href = url;
        }
    }

    var SearchByName = function(){
        const url = "/Monumentos/SearchMonumentByName?name=" + document.getElementById("monumentName").value;
        location.href = url;
    }
</script>